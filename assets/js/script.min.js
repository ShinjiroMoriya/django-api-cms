$.ajaxSetup({beforeSend:function(a,b){function c(a){var b=null;if(document.cookie&&document.cookie!=''){var c=document.cookie.split(';');for(var d=0;d<c.length;d++){var e=jQuery.trim(c[d]);if(e.substring(0,a.length+1)==(a+'=')){b=decodeURIComponent(e.substring(a.length+1));break;}}}return b;}if(!(/^http:.*/.test(b.url)||/^https:.*/.test(b.url)))a.setRequestHeader("X-CSRFToken",c('csrftoken'));}});$('form').on('submit',function(){$(document).find('#loading').show();});$('body').append('<div id="loading" class="loading"></div>');$('.status_select').on('change',function(){var a=$(this).attr('data-post_id');var b=$(this).val();var c='/post/status/'+a;$.ajax({type:'POST',url:c,cache:false,data:{'status':b},context:this}).done(function(a){$('.header_status_text').text('更新しました');$('.header_status').addClass('_show _success');}).fail(function(a){$('.header_status_text').text('通信エラー');$('.header_status').addClass('_show _error');}).always(function(a){setTimeout(function(){$('.header_status_text').text('');$('.header_status').removeClass('_show _success _error');},1000);});});if($('#tinymce_textarea').length!=0)tinymce.init({selector:"textarea",plugins:["advlist autolink lists link image charmap preview hr","searchreplace wordcount visualblocks visualchars code fullscreen","insertdatetime nonbreaking save table contextmenu directionality","paste textcolor colorpicker textpattern"],default_link_target:"_blank",language:"ja",toolbar:"undo redo | bold italic | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | link image forecolor backcolor",link_title:false,link_list:'/api/pdf',image_list:'/api/image',file_picker_callback:function(a,b,c){if(c.filetype=='file'){$('#pdf_uploader').trigger('click');$('#pdf_uploader').on('change',function(){var b=this.files[0];if($("input[name='pdf_file']").val()=='')return false;$('#loading').show();var c=new FormData($('#pdf_form').get(0));c.append('file',b);$.ajax({type:'POST',url:'/pdf/add',cache:false,data:c,processData:false,contentType:false}).done(function(b){a(b.pdf_url,{text:b.title});}).fail(function(a){$('.header_status_text').text('通信エラー');$('.header_status').addClass('_show _error');}).always(function(a){$('#loading').hide();setTimeout(function(){$('.header_status_text').text('');$('.header_status').removeClass('_show _success _error');},1000);});});}if(c.filetype=='image'){$('#upload').trigger('click');$('#upload').on('change',function(){var b=this.files[0];if($("input[name='image_file']").val()=='')return false;$('#loading').show();var c=new FormData($('#image_upload').get(0));c.append('file',b);$.ajax({type:'POST',url:'/image/add',cache:false,data:c,processData:false,contentType:false}).done(function(b){a(b.image_url);}).fail(function(a){$('.header_status_text').text('通信エラー');$('.header_status').addClass('_show _error');}).always(function(a){$('#loading').hide();setTimeout(function(){$('.header_status_text').text('');$('.header_status').removeClass('_show _success _error');},1000);});});}}});